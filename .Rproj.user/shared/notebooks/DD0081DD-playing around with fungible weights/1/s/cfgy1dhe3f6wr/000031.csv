"0","set.seed(1)"
"0","#fungible(R.X = matrix(c(1,.5,.5,.5,1,.5,.5,.5,1),3,3), "
"0","      #   rxy = c(.5,.5,.5),"
"0","      #   r.yhata.yhatb = .99,"
"0","      #   sets = 10)"
"0",""
"0","n_preds = 10"
"0","pred_cors = .5"
"0","cor_vari = .01"
"0","rxy = .5"
"0","rxy_vari = .1"
"0",""
"0","#maybe this is better way of making matrices"
"0","R.X = diag(1,n_preds)"
"0","noise = rnorm(length(R.X[lower.tri(R.X)]),sd = cor_vari)"
"0","R.X[lower.tri(R.X)] = pred_cors + noise"
"0","R.X = t(R.X)"
"0","R.X[lower.tri(R.X)] = pred_cors + noise"
"0",""
"0",""
"0","## vector of predictor-criterion correlations "
"0","rxy <- rxy + rnorm(n_preds,sd = rxy_vari)"
"0"," "
"0","## OLS standardized regression coefficients"
"0","b <- solve(R.X) %*% rxy"
"0"," "
"0","## Coefficient of determination (Rsq)"
"0","OLSRSQ <- t(b) %*% R.X %*% b"
"0",""
"0","## theta controls the correlation between "
"0","## yhatb: predicted criterion scores using OLS coefficients"
"0","## yhata: predicted criterion scores using alternate weights"
"0","theta <- .01"
"0",""
"0","## desired correlation between yhata and yhatb "
"0","r.yhata.yhatb <- sqrt( 1 - (theta)/OLSRSQ)"
"0",""
"0","## number of returned sets of fungible weight vectors"
"0","Nsets <- 1000"
"0",""
"0","output <- fungible(R.X, rxy, r.yhata.yhatb, sets = Nsets)"
"1","

Generating alternate weights . . . 
"
"1","

"
"1","  r.yhata.yhatb = "
"1"," "
"1","0.9916317"
"1"," "
"1","
"
"1","  RSQb = "
"1"," "
"1","0.6"
"1"," "
"1","
"
"1","  RSQa = "
"1"," "
"1","0.59"
"1"," "
"1","
"
"1","  Relative loss = RSQb - RSQa = "
"1"," "
"1","0.01"
"1"," "
"1","
"
"1","  OLS b = "
"1"," "
"1","-0.089"
"1"," "
"1","0.13"
"1"," "
"1","0.226"
"1"," "
"1","0.028"
"1"," "
"1","0.243"
"1"," "
"1","0.129"
"1"," "
"1","-0.058"
"1"," "
"1","0.125"
"1"," "
"1","-0.157"
"1"," "
"1","0.36"
"1"," "
"1","

"
"1","
"
"1","
Summary of generated alternate weights
"
"1","       "
"1","          a1"
"1","         a2"
"1","        a3"
"1","           a4"
"1","        a5"
"1","          a6"
"1","
Min.   "
"1"," -0.20088067"
"1"," 0.01086836"
"1"," 0.1090329"
"1"," -0.094389491"
"1"," 0.1256737"
"1"," -0.00170736"
"1","
1st Qu."
"1"," -0.11882998"
"1"," 0.09507847"
"1"," 0.1891163"
"1"," -0.004318648"
"1"," 0.2070962"
"1","  0.09555997"
"1","
Median "
"1"," -0.08748040"
"1"," 0.12841657"
"1"," 0.2224637"
"1","  0.029173583"
"1"," 0.2419635"
"1","  0.12746294"
"1","
Mean   "
"1"," -0.08765523"
"1"," 0.12725139"
"1"," 0.2225772"
"1","  0.028053296"
"1"," 0.2398310"
"1","  0.12717752"
"1","
3rd Qu."
"1"," -0.05682100"
"1"," 0.16002353"
"1"," 0.2553196"
"1","  0.059671616"
"1"," 0.2721068"
"1","  0.16018466"
"1","
Max.   "
"1","  0.02188084"
"1"," 0.23662442"
"1"," 0.3423110"
"1","  0.142986560"
"1"," 0.3549280"
"1","  0.24432565"
"1","
"
"1","       "
"1","          a7"
"1","          a8"
"1","          a9"
"1","       a10"
"1","
Min.   "
"1"," -0.17852801"
"1"," 0.005805152"
"1"," -0.27072071"
"1"," 0.2515355"
"1","
1st Qu."
"1"," -0.09035589"
"1"," 0.091407954"
"1"," -0.18936515"
"1"," 0.3241717"
"1","
Median "
"1"," -0.05869570"
"1"," 0.122674037"
"1"," -0.15569459"
"1"," 0.3523865"
"1","
Mean   "
"1"," -0.05790797"
"1"," 0.123040008"
"1"," -0.15548006"
"1"," 0.3535392"
"1","
3rd Qu."
"1"," -0.02681496"
"1"," 0.154586256"
"1"," -0.12250946"
"1"," 0.3821360"
"1","
Max.   "
"1","  0.05555013"
"1"," 0.236247758"
"1"," -0.04693179"
"1"," 0.4556276"
"1","
"
"1","
"
"1","
 Expected a 
"
"1","     "
"1","        [,1]"
"1","
 [1,]"
"1"," -0.08771071"
"1","
 [2,]"
"1","  0.12810543"
"1","
 [3,]"
"1","  0.22230580"
"1","
 [4,]"
"1","  0.02711783"
"1","
 [5,]"
"1","  0.23873316"
"1","
 [6,]"
"1","  0.12645402"
"1","
 [7,]"
"1"," -0.05662716"
"1","
 [8,]"
"1","  0.12316622"
"1","
 [9,]"
"1"," -0.15482967"
"1","
[10,]"
"1","  0.35405910"
"1","
"
"1","
Expected Covariance Matrix 
"
"1","     "
"1","          [,1]"
"1","          [,2]"
"1","          [,3]"
"1","          [,4]"
"1","          [,5]"
"1","
 [1,]"
"1","  0.0019859294"
"1"," -0.0001492179"
"1"," -0.0001600302"
"1"," -0.0001524388"
"1"," -0.0002131187"
"1","
 [2,]"
"1"," -0.0001492179"
"1","  0.0019537001"
"1"," -0.0002374805"
"1"," -0.0002763968"
"1"," -0.0002660614"
"1","
 [3,]"
"1"," -0.0001600302"
"1"," -0.0002374805"
"1","  0.0019122105"
"1"," -0.0002463289"
"1"," -0.0003122147"
"1","
 [4,]"
"1"," -0.0001524388"
"1"," -0.0002763968"
"1"," -0.0002463289"
"1","  0.0019933243"
"1"," -0.0002256437"
"1","
 [5,]"
"1"," -0.0002131187"
"1"," -0.0002660614"
"1"," -0.0003122147"
"1"," -0.0002256437"
"1","  0.0019102000"
"1","
 [6,]"
"1"," -0.0001789583"
"1"," -0.0002007885"
"1"," -0.0002674119"
"1"," -0.0001946894"
"1"," -0.0002980826"
"1","
 [7,]"
"1"," -0.0001772653"
"1"," -0.0001035917"
"1"," -0.0002190251"
"1"," -0.0002018805"
"1"," -0.0001681575"
"1","
 [8,]"
"1"," -0.0001835327"
"1"," -0.0002756066"
"1"," -0.0002698205"
"1"," -0.0001268813"
"1"," -0.0002490551"
"1","
 [9,]"
"1"," -0.0002531924"
"1"," -0.0001660127"
"1"," -0.0001311372"
"1"," -0.0001720419"
"1"," -0.0001137443"
"1","
[10,]"
"1"," -0.0001707410"
"1"," -0.0002956038"
"1"," -0.0002605733"
"1"," -0.0002451710"
"1"," -0.0002907859"
"1","
"
"1","     "
"1","          [,6]"
"1","          [,7]"
"1","          [,8]"
"1","          [,9]"
"1","         [,10]"
"1","
 [1,]"
"1"," -0.0001789583"
"1"," -0.0001772653"
"1"," -0.0001835327"
"1"," -2.531924e-04"
"1"," -1.707410e-04"
"1","
 [2,]"
"1"," -0.0002007885"
"1"," -0.0001035917"
"1"," -0.0002756066"
"1"," -1.660127e-04"
"1"," -2.956038e-04"
"1","
 [3,]"
"1"," -0.0002674119"
"1"," -0.0002190251"
"1"," -0.0002698205"
"1"," -1.311372e-04"
"1"," -2.605733e-04"
"1","
 [4,]"
"1"," -0.0001946894"
"1"," -0.0002018805"
"1"," -0.0001268813"
"1"," -1.720419e-04"
"1"," -2.451710e-04"
"1","
 [5,]"
"1"," -0.0002980826"
"1"," -0.0001681575"
"1"," -0.0002490551"
"1"," -1.137443e-04"
"1"," -2.907859e-04"
"1","
 [6,]"
"1","  0.0019714644"
"1"," -0.0001714260"
"1"," -0.0001939429"
"1"," -1.556392e-04"
"1"," -3.356331e-04"
"1","
 [7,]"
"1"," -0.0001714260"
"1","  0.0019636016"
"1"," -0.0002209970"
"1"," -2.206239e-04"
"1"," -1.711116e-04"
"1","
 [8,]"
"1"," -0.0001939429"
"1"," -0.0002209970"
"1","  0.0019841300"
"1"," -1.836189e-04"
"1"," -3.050558e-04"
"1","
 [9,]"
"1"," -0.0001556392"
"1"," -0.0002206239"
"1"," -0.0001836189"
"1","  1.939891e-03"
"1"," -7.398139e-05"
"1","
[10,]"
"1"," -0.0003356331"
"1"," -0.0001711116"
"1"," -0.0003050558"
"1"," -7.398139e-05"
"1","  1.742351e-03"
"1","
"
"1","
Expected Correlation Matrix 
"
"1","     "
"1","        [,1]"
"1","        [,2]"
"1","        [,3]"
"1","        [,4]"
"1","        [,5]"
"1","        [,6]"
"1","
 [1,]"
"1","  1.00000000"
"1"," -0.07575477"
"1"," -0.08212063"
"1"," -0.07661690"
"1"," -0.10942091"
"1"," -0.09044312"
"1","
 [2,]"
"1"," -0.07575477"
"1","  1.00000000"
"1"," -0.12286586"
"1"," -0.14006031"
"1"," -0.13772522"
"1"," -0.10230937"
"1","
 [3,]"
"1"," -0.08212063"
"1"," -0.12286586"
"1","  1.00000000"
"1"," -0.12617071"
"1"," -0.16336015"
"1"," -0.13772677"
"1","
 [4,]"
"1"," -0.07661690"
"1"," -0.14006031"
"1"," -0.12617071"
"1","  1.00000000"
"1"," -0.11563646"
"1"," -0.09821070"
"1","
 [5,]"
"1"," -0.10942091"
"1"," -0.13772522"
"1"," -0.16336015"
"1"," -0.11563646"
"1","  1.00000000"
"1"," -0.15360409"
"1","
 [6,]"
"1"," -0.09044312"
"1"," -0.10230937"
"1"," -0.13772677"
"1"," -0.09821070"
"1"," -0.15360409"
"1","  1.00000000"
"1","
 [7,]"
"1"," -0.08976665"
"1"," -0.05288948"
"1"," -0.11303148"
"1"," -0.10204192"
"1"," -0.08682605"
"1"," -0.08712754"
"1","
 [8,]"
"1"," -0.09245843"
"1"," -0.13998310"
"1"," -0.13852303"
"1"," -0.06380042"
"1"," -0.12792960"
"1"," -0.09806055"
"1","
 [9,]"
"1"," -0.12899713"
"1"," -0.08527540"
"1"," -0.06808780"
"1"," -0.08748960"
"1"," -0.05908832"
"1"," -0.07958586"
"1","
[10,]"
"1"," -0.09178846"
"1"," -0.16021867"
"1"," -0.14275595"
"1"," -0.13155647"
"1"," -0.15939185"
"1"," -0.18109330"
"1","
"
"1","     "
"1","        [,7]"
"1","        [,8]"
"1","        [,9]"
"1","       [,10]"
"1","
 [1,]"
"1"," -0.08976665"
"1"," -0.09245843"
"1"," -0.12899713"
"1"," -0.09178846"
"1","
 [2,]"
"1"," -0.05288948"
"1"," -0.13998310"
"1"," -0.08527540"
"1"," -0.16021867"
"1","
 [3,]"
"1"," -0.11303148"
"1"," -0.13852303"
"1"," -0.06808780"
"1"," -0.14275595"
"1","
 [4,]"
"1"," -0.10204192"
"1"," -0.06380042"
"1"," -0.08748960"
"1"," -0.13155647"
"1","
 [5,]"
"1"," -0.08682605"
"1"," -0.12792960"
"1"," -0.05908832"
"1"," -0.15939185"
"1","
 [6,]"
"1"," -0.08712754"
"1"," -0.09806055"
"1"," -0.07958586"
"1"," -0.18109330"
"1","
 [7,]"
"1","  1.00000000"
"1"," -0.11196300"
"1"," -0.11304129"
"1"," -0.09250917"
"1","
 [8,]"
"1"," -0.11196300"
"1","  1.00000000"
"1"," -0.09359307"
"1"," -0.16406892"
"1","
 [9,]"
"1"," -0.11304129"
"1"," -0.09359307"
"1","  1.00000000"
"1"," -0.04024074"
"1","
[10,]"
"1"," -0.09250917"
"1"," -0.16406892"
"1"," -0.04024074"
"1","  1.00000000"
"1","
"
"0","diag(output$cov.a)"
"1"," [1]"
"1"," 0.001985929"
"1"," 0.001953700"
"1"," 0.001912211"
"1"," 0.001993324"
"1"," 0.001910200"
"1"," 0.001971464"
"1","
"
"1"," [7]"
"1"," 0.001963602"
"1"," 0.001984130"
"1"," 0.001939891"
"1"," 0.001742351"
"1","
"
"0","#diag(var(output$a))"
"0",""
"0",""
